(this.webpackJsonpnotes_collections=this.webpackJsonpnotes_collections||[]).push([[0],{128:function(e,t,n){e.exports=n(157)},137:function(e,t,n){},157:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(12),l=n.n(i),o=n(46),s=n(25),c=n(57),u=n(47),d=n(9),h="CHANGE_CURRENT_MENU",m="POPULATE_NOTE",p="SIGN_UP",v="LOG_IN",f="LOG_OUT",g="SAVE_NOTES",b="SHOW_ERROR",_="HIDE_ERROR",k={currentMenu:"",notes:[]};function E(e,t){var n=t.payload,a=n.route,r=n.note_children,i=a.split("-").map((function(e){return Number(e)}));return function e(t,n){var a=i[n-1];if(i.length!==n)return e(t[a].children,n+1);t[a].children=r}(e.notes,1),Object(d.a)({},e)}var O={token:"",userData:{}};var j={show_err:!1,msg:""};var y=Object(c.b)({user:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:O,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case v:case p:return localStorage.setItem("user",JSON.stringify(t.payload)),Object(d.a)(Object(d.a)({},e),{},{token:t.payload.token,userData:{username:t.payload.username}});case f:return localStorage.removeItem("user"),Object(d.a)(Object(d.a)({},e),{},{token:"",userData:{}});default:return Object(d.a)({},e)}},note:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:k,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case g:return Object(d.a)(Object(d.a)({},e),{},{notes:t.payload});case m:return e.notes=Object(u.a)(e.notes),E(e,t);case h:return Object(d.a)(Object(d.a)({},e),{},{currentMenu:t.payload});default:return Object(d.a)({},e)}},error:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:j,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case b:return{show_err:!0,msg:t.payload.response.data.error.message};case _:return{show_err:!1,msg:""};default:return Object(d.a)({},e)}}}),C=Object(c.c)(y,window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__());function w(e){return{type:v,payload:e}}function S(){return{type:f}}n(137);var x=n(13),R=n(14),V=n(16),L=n(15),N=n(82),T=n(227),D=n(225),I=n(158),M=n(18),A=n(226),z=n(198),P=n(201),B=n(228),q=n(110),U=n(81),W=n(75),G=n.n(W),Z=n(108);function F(e,t){var n={isValid:!0,msg:[]};for(var a in t)switch(a){case"isRequired":Y(e,n);break;case"maxLen":$(e,t[a],n);break;case"matchPattern":K(e,t[a],n)}return n}function H(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return n?X(e,t):J(e,t)}function J(e,t){var n=!0;for(var a in e)t.includes(a)||(n=e[a].valid.isValid&&n);return n}function X(e,t){var n=!0;for(var a in e)if(!t.includes(a))if(Array.isArray(e[a])){var r,i=Object(Z.a)(e[a]);try{for(i.s();!(r=i.n()).done;){n=J(r.value,t)&&n}}catch(l){i.e(l)}finally{i.f()}}else n=e[a].valid.isValid&&n;return n}function Y(e,t){""===e.trim()&&(t.isValid=!1,t.msg.push("Empty Field"))}function $(e,t,n){e.length>t&&(n.isValid=!1,n.msg.push("Field length is more than ".concat(t," characters")))}function K(e,t,n){t.test(e)||(n.isValid=!1,n.msg.push("This value isn't a link"))}function Q(e){return{type:h,payload:e}}function ee(e){return{type:b,payload:e}}var te=Object(I.a)(A.a)({marginTop:"10px"}),ne=function(e){Object(V.a)(n,e);var t=Object(L.a)(n);function n(){return Object(x.a)(this,n),t.apply(this,arguments)}return Object(R.a)(n,[{key:"render",value:function(){var e=this.props.title,t=e.valid,n=e.touch,a=e.value;return r.a.createElement(te,{value:a,label:"Title",inputProps:{"data-testid":"edit-title"},error:n&&!t.isValid,helperText:t.msg.join(", "),fullWidth:!0,required:!0,name:"title",onChange:this.props.callback})}}]),n}(r.a.Component),ae=n(163),re=Object(ae.a)({root:{marginTop:"10px"}});function ie(e){var t=re();return r.a.createElement(A.a,{className:t.root,id:"standard-multiline-flexible",label:"Description",name:"desc",fullWidth:!0,multiline:!0,value:e.value,rowsMax:4,onChange:e.callback})}var le=n(197),oe=n(199),se=n(200),ce=n(160),ue=n(109),de=n.n(ue),he=function(e){Object(V.a)(n,e);var t=Object(L.a)(n);function n(){return Object(x.a)(this,n),t.apply(this,arguments)}return Object(R.a)(n,[{key:"render",value:function(){var e=this;return r.a.createElement(me,null,r.a.createElement(z.a,{"data-testid":"btn-create-link",onClick:this.props.createLink},"Create New Link"),r.a.createElement(le.a,{"data-testid":"edit-links"},this.props.links.map((function(t,n){return r.a.createElement(oe.a,{key:n},r.a.createElement(pe,null,r.a.createElement(A.a,{name:"link",label:"Link",value:t.link.value,error:t.link.touch&&!t.link.valid.isValid,helperText:t.link.valid.msg.join(", "),inputProps:{"data-testid":"edit-link-".concat(n)},required:!0,fullWidth:!0,onChange:function(t){return e.props.handleChange(t,n,"link")}}),r.a.createElement(A.a,{name:"desc",label:"Description",fullWidth:!0,value:t.desc.value,onChange:function(t){return e.props.handleChange(t,n,"link")},multiline:!0})),r.a.createElement(se.a,null,r.a.createElement(ce.a,{edge:"end",onClick:function(){e.props.deleteLink(t)},"aria-label":"delete"},r.a.createElement(de.a,null))))}))))}}]),n}(a.Component),me=Object(I.a)("div")({marginTop:"20px"}),pe=Object(I.a)("div")({width:"98%"}),ve=n(35),fe=n.n(ve);function ge(e){return Promise.allSettled(e.map((function(e){return function(e){return fe()({method:"get",url:"https://cors-anywhere.herokuapp.com/"+e,headers:{Cookie:"SameSite=None; Secure"}})}(e.link)}))).then((function(t){var n=t.map((function(t,n){try{if("fulfilled"===t.status){var a=(new DOMParser).parseFromString(t.value.data,"text/html"),r=a.querySelector('meta[property="og:title"]').getAttribute("content"),i=a.querySelector('meta[property="og:image"]').getAttribute("content");return Object(d.a)(Object(d.a)({},e[n]),{},{link_title:r,image:i})}if("rejected"===t.status)return e[n]}catch(l){return e[n]}}));return Promise.resolve(n)}))}var be="/create",_e="/edit",ke="/home",Ee="/sign_up",Oe=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"http://localhost:8000",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;Object(x.a)(this,e),this.base_url=t,this.version_api=n}return Object(R.a)(e,[{key:"sign_up",value:function(e){return fe()({method:"post",url:"".concat(this.base_url,"/api/v").concat(this.version_api,"/users/"),data:e})}},{key:"log_in",value:function(e){return fe()({method:"post",url:"".concat(this.base_url,"/api/v").concat(this.version_api,"/users/login"),data:e})}},{key:"get_notes",value:function(e){return fe()({method:"get",url:"".concat(this.base_url,"/api/v").concat(this.version_api,"/notes/"),headers:{Authorization:"Bearer "+e}})}},{key:"get_notes_titles",value:function(e){return fe()({method:"get",url:"".concat(this.base_url,"/api/v").concat(this.version_api,"/notes/titles/"),headers:{Authorization:"Bearer "+e}})}},{key:"get_notes_children",value:function(e,t){return fe()({method:"get",url:"".concat(this.base_url,"/api/v").concat(this.version_api,"/notes/").concat(t),headers:{Authorization:"Bearer "+e}})}},{key:"save_note",value:function(e,t){return fe()({method:"post",url:"".concat(this.base_url,"/api/v").concat(this.version_api,"/notes/"),headers:{Authorization:"Bearer "+t},data:e})}},{key:"delete_note",value:function(e,t){return fe()({method:"delete",url:"".concat(this.base_url,"/api/v").concat(this.version_api,"/notes/").concat(e),headers:{Authorization:"Bearer "+t}})}},{key:"update_note",value:function(e,t){return fe()({method:"put",url:"".concat(this.base_url,"/api/v").concat(this.version_api,"/notes/"),headers:{Authorization:"Bearer "+t},data:e})}}]),e}(),je=function(e){Object(V.a)(n,e);var t=Object(L.a)(n);function n(e){var a;return Object(x.a)(this,n),(a=t.call(this,e)).goBack=function(){a.props.history.goBack()},a.handleChange=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"note",r=e.target.name,i=e.target.value,l=Object(d.a)({},a.state.formControl);if("note"===n){var o=Object(d.a)({},l[r]);o.value=i,o.touch=!0,o.valid=F(i,o.validationRules),l[r]=o}else{var s=Object(d.a)({},l.links[t][r]);s.value=i,s.touch=!0,s.valid=F(i,s.validationRules),l.links[t][r]=s}a.setState({formValid:H(l,["_id","link_title","image"],!0),formControl:l})},a.deleteLink=function(e){var t=Object(d.a)({},a.state.formControl);t.links=t.links.filter((function(t){return t.id!==e.id})),a.setState({formControl:t,formValid:H(t,["_id","link_title","image"],!0)})},a.createLink=function(){var e=Object(d.a)({},a.state.formControl);e.links=[].concat(Object(u.a)(a.state.formControl.links),[{id:Date.now(),link:{value:"",valid:{isValid:!1,msg:[]},touch:!1,validationRules:{isRequired:!0,matchPattern:/[-a-zA-Z0-9@:%_+.~#?&/=]{2,256}\.[a-z]{2,4}\b(\/[-a-zA-Z0-9@:%_+.~#?&/=]*)?/gi}},desc:{value:"",touch:!1,valid:{isValid:!0,msg:[]},validationRules:{}},link_title:"",image:""}]),a.setState({formValid:!1,formControl:e})},a.handleChangeRoute=function(e,t,n){"select-option"===n?a.setState({parent:t._id}):"clear"===n&&a.setState({parent:""})},a.submit=function(e){e.preventDefault();var t=a.state,n=t.formControl,r=t.parent,i=a.props.show_err,l=a.props.token,o=new Oe,s={title:n.title.value,desc:n.desc.value,links:n.links.map((function(e){return{id:e.id,link:e.link.value,desc:e.desc.value,link_title:e.link.value,image:""}})),head:!0,children:[]};r&&(s.parent=r,s.head=!1),a.setState({saving:!0}),ge(s.links).then((function(e){return s.links=e,o.save_note(s,l)})).then((function(e){a.setState({saving:!1,success:!0}),a.props.change_current_note(),setTimeout((function(){return a.props.history.push(ke)}),1e3)})).catch((function(e){return i(e)}))},a.state={notes_titles:[],formValid:!1,formControl:{title:{value:"",valid:{isValid:!1,msg:[]},touch:!1,validationRules:{maxLen:50,isRequired:!0}},desc:{value:"",touch:!1,valid:{isValid:!0,msg:[]},validationRules:{}},links:[]},parent:"",saving:!1,success:!1,place_len:a.props.notes.length},a}return Object(R.a)(n,[{key:"componentDidMount",value:function(){var e=this,t=this.props.token,n=this.show_err;(new Oe).get_notes_titles(t).then((function(t){e.setState({notes_titles:t.data})})).catch((function(e){return n(e)}))}},{key:"render",value:function(){var e=this.state.formControl,t=e.title,n=e.desc,a=e.links,i=this.state,l=i.success,o=i.saving;return o||l?r.a.createElement("div",{className:"note-create"},l&&r.a.createElement(we,{fontSize:"large",style:{color:U.a[500]}}),o&&r.a.createElement(Ce,null)):r.a.createElement(T.a,{padding:1,"data-testid":"note-create",className:"note-create"},r.a.createElement("form",null,r.a.createElement(B.a,{id:"combo-box-demo",ListboxProps:{"data-testid":"auto-list"},options:this.state.notes_titles,"data-testid":"autocomplete",disabled:!(this.state.notes_titles.length>0),getOptionLabel:function(e){return e.title},renderInput:function(e){return r.a.createElement(A.a,Object.assign({},e,{label:"Parent Node",variant:"outlined"}))},onChange:this.handleChangeRoute}),r.a.createElement(ne,{title:t,callback:this.handleChange}),r.a.createElement(ie,{value:n.value,callback:this.handleChange}),r.a.createElement(he,{createLink:this.createLink,links:a,handleChange:this.handleChange,deleteLink:this.deleteLink}),r.a.createElement(z.a,{"data-testid":"btn-cancel",onClick:this.goBack},"Cancel"),r.a.createElement(z.a,{"data-testid":"btn-create",onClick:this.submit,disabled:!this.state.formValid,type:"submit"},"save")))}}]),n}(a.Component),ye=Object(s.b)((function(e){return{notes:e.note.notes,token:e.user.token}}),(function(e){return{change_current_note:function(){return e(Q(""))},show_err:function(t){return e(ee(t))}}}))(je),Ce=Object(q.a)(P.a)({marginLeft:"calc(50% - 20px)"}),we=Object(q.a)(G.a)({marginLeft:"calc(50% - 20px)"}),Se=n(31),xe=n(215),Re=n(229),Ve=n(214),Le=n(206),Ne=n(202),Te=n(203),De=n(204),Ie=n(205),Me=function(e){Object(V.a)(n,e);var t=Object(L.a)(n);function n(e){var a;return Object(x.a)(this,n),(a=t.call(this,e)).handleClick=function(e){var t=a.props,n=t.item,r=t.route_l,i=t.token,l=t.populate_note;if(n.hasOwnProperty("children")&&n.children.length>0&&"string"===typeof n.children[0]){var o=new Oe;a.setState({spinner:!0}),o.get_notes_children(i,n._id).then((function(e){a.setState({spinner:!1},(function(){return l(e.data,r)}))})).catch((function(e){return console.log(e)}))}},a.state={spinner:!1},a}return Object(R.a)(n,[{key:"render",value:function(){var e=this.state.spinner,t=this.props.children;return e?r.a.createElement(T.a,{textAlign:"center"},r.a.createElement(P.a,{size:25})):r.a.createElement(T.a,{onClick:this.handleClick},t)}}]),n}(a.Component),Ae=Object(s.b)((function(e){return{token:e.user.token}}),{populate_note:function(e,t){return{type:m,payload:{note_children:e,route:t}}}})(Me),ze=function(e){Object(V.a)(n,e);var t=Object(L.a)(n);function n(){return Object(x.a)(this,n),t.apply(this,arguments)}return Object(R.a)(n,[{key:"renderTree",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return e.map((function(e,i){var l="";return l=0===a?"".concat(i):"".concat(n,"-").concat(i),r.a.createElement(Ae,{key:"".concat(e._id,"-").concat(i),item:e,route_l:l},r.a.createElement(Ne.a,{nodeId:l,label:e.title},e.hasOwnProperty("children")&&e.children.length>0?t.renderTree(e.children,l,a+1):null))}))}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"sidebar"},r.a.createElement(Te.a,{defaultCollapseIcon:r.a.createElement(De.a,null),defaultExpandIcon:r.a.createElement(Ie.a,null),onNodeSelect:function(t,n){return e.props.change_current_note(n)}},this.renderTree(this.props.notes)),r.a.createElement(z.a,null,r.a.createElement(Le.a,{color:"textPrimary",component:o.b,to:be},"+ Create Note")))}}]),n}(a.Component);function Pe(e,t){return e.length?t.length>1?function(e,t){var n=t.split("-").map((function(e){return Number(e)}));return function e(t,a){var r=n[a-1];return n.length===a?t[r]:e(t[r].children,a+1)}(e,1)}(e,t):function(e,t){var n=Number(t);return e[n]}(e,t):{}}var Be=n(207),qe=n(232),Ue=n(208),We=n(209),Ge=n(79),Ze=n.n(Ge),Fe=function(e){Object(V.a)(n,e);var t=Object(L.a)(n);function n(){return Object(x.a)(this,n),t.apply(this,arguments)}return Object(R.a)(n,[{key:"renderListItems",value:function(){var e=this.props,t=e.note_children,n=e.change_current_note,a=e.currentMenu;return t.map((function(e,t){return r.a.createElement(oe.a,{key:t},r.a.createElement(Be.a,{primary:r.a.createElement($e,{href:"#",underline:"none",onClick:function(){return n("".concat(a,"-").concat(t))},variant:"body1"},t+1,". ",e.title)}))}))}},{key:"render",value:function(){return this.props.note_children.length?r.a.createElement(He,{defaultExpanded:!0},r.a.createElement(Je,{expandIcon:r.a.createElement(Ze.a,null),"aria-controls":"panel1a-content",id:"panel1a-header"},r.a.createElement(Se.a,{variant:"h6"},"Notes")),r.a.createElement(Xe,null,r.a.createElement(Ye,null,this.renderListItems()))):null}}]),n}(a.Component),He=Object(I.a)(qe.a)({boxShadow:"none",marginTop:"10px"}),Je=Object(I.a)(Ue.a)({padding:"0"}),Xe=Object(I.a)(We.a)({padding:"8px 0 16px"}),Ye=Object(I.a)(le.a)({width:"30%"}),$e=Object(I.a)(Le.a)({textTransform:"capitalize"}),Ke=n(210),Qe=n(211),et=n(212),tt=n(213),nt=function(e){Object(V.a)(n,e);var t=Object(L.a)(n);function n(){return Object(x.a)(this,n),t.apply(this,arguments)}return Object(R.a)(n,[{key:"get_domain",value:function(e){return e.match(/\/\w+/)[0].slice(1)}},{key:"renderLeft",value:function(e){return e.image.length>0?r.a.createElement(st,{image:e.image}):r.a.createElement(ot,null,r.a.createElement(Se.a,{variant:"h6"},this.get_domain(e.link)))}},{key:"renderCards",value:function(){var e=this;return this.props.links.map((function(t,n){return r.a.createElement(lt,{key:n},e.renderLeft(t),r.a.createElement(ct,null,r.a.createElement(ut,{disableTypography:!0,title:r.a.createElement(Le.a,{variant:"h6",rel:"noopener",href:t.link,target:"_blank",underline:"none"},t.link_title.substring(0,45))}),r.a.createElement(dt,null,r.a.createElement(Se.a,{variant:"body2"},t.desc))))}))}},{key:"render",value:function(){return this.props.links.length?r.a.createElement(at,{defaultExpanded:!0},r.a.createElement(rt,{expandIcon:r.a.createElement(Ze.a,null),"aria-controls":"panel1a-content",id:"panel2a-header"},r.a.createElement(Se.a,{variant:"h6"},"Links")),r.a.createElement(it,null,this.renderCards())):null}}]),n}(a.Component),at=Object(I.a)(qe.a)({boxShadow:"none",marginTop:"10px"}),rt=Object(I.a)(Ue.a)({padding:"0"}),it=Object(I.a)(We.a)({flexDirection:"column",padding:"8px 0 16px"}),lt=Object(I.a)(Ke.a)({display:"flex",width:"100%",marginTop:7}),ot=Object(I.a)(Qe.a)({flexBasis:"20%",padding:"5px",display:"flex",justifyContent:"center",alignItems:"center"}),st=Object(I.a)(et.a)({flexBasis:"15%"}),ct=Object(I.a)(Qe.a)({flexGrow:"1",padding:"5px !important"}),ut=Object(I.a)(tt.a)({padding:0}),dt=Object(I.a)(Qe.a)({padding:"5px 0 0 0 !important"}),ht={change_current_note:Q,save_notes:function(e){return{type:g,payload:e}},log_out_user:S,show_err:ee},mt=function(e){Object(V.a)(n,e);var t=Object(L.a)(n);function n(e){var a;return Object(x.a)(this,n),(a=t.call(this,e)).handleEdit=function(){var e=a.props,t=e.history,n=e.currentMenu;t.push("".concat(_e,"/").concat(n))},a.handleClose=function(){a.setState({show_snack:!1,error:""})},a.state={spinner:!0,show_snack:!1,error:""},a}return Object(R.a)(n,[{key:"componentDidMount",value:function(){var e=this,t=new Oe,n=this.props,a=n.token,r=n.save_notes,i=n.log_out_user;t.get_notes(a).then((function(t){r(t.data),e.setState({spinner:!1})})).catch((function(e){var t=e.response.data;ee(e),"TokenExpiredError"===t.error.name&&setTimeout((function(){return i()}),4e3)}))}},{key:"render",value:function(){if(this.state.spinner)return r.a.createElement(T.a,{display:"flex",justifyContent:"center"},r.a.createElement(P.a,null));var e=this.props,t=e.currentMenu,n={notes:e.notes,currentMenu:t,change_current_note:e.change_current_note},a=n.notes.length>0,i=n.currentMenu.length>0;if(!a)return pt(r.a.createElement("div",{className:"display"},r.a.createElement(Se.a,{variant:"subtitle1"},"You don't have any notes, but you can create new if you press 'create note'")),n);if(a&&!i)return pt(r.a.createElement("div",{className:"display"},r.a.createElement(Se.a,{variant:"subtitle1"},"Choose note that you want to see")),n);var l=Pe(n.notes,n.currentMenu);return pt(r.a.createElement("div",{className:"display"},r.a.createElement("div",{"data-testid":"note",className:"note"},r.a.createElement(T.a,{display:"flex",alignItems:"center",justifyContent:"space-between"},r.a.createElement(Se.a,{variant:"h5"},l.title),r.a.createElement(z.a,{id:"edit-btn",onClick:this.handleEdit},r.a.createElement(Ve.a,null))),r.a.createElement(Se.a,{variant:"body1"},l.desc),r.a.createElement(Fe,{currentMenu:n.currentMenu,change_current_note:n.change_current_note,note_children:l.children}),r.a.createElement(nt,{links:l.links}))),n)}}]),n}(a.Component);function pt(e,t){return r.a.createElement(xe.a,{container:!0,spacing:1},r.a.createElement(Re.a,{smDown:!0},r.a.createElement(xe.a,{item:!0,xs:2},r.a.createElement(ze,t))),r.a.createElement(xe.a,{item:!0,xs:!0},r.a.createElement(T.a,{padding:1},e)))}var vt=Object(s.b)((function(e){return{currentMenu:e.note.currentMenu,notes:e.note.notes,token:e.user.token}}),ht)(mt),ft=n(216),gt=n(217),bt=n(218),_t=n(219),kt=n(220);var Et=function(e){Object(V.a)(n,e);var t=Object(L.a)(n);function n(e){var a;return Object(x.a)(this,n),(a=t.call(this,e)).goBack=function(){a.props.history.goBack()},a.handleChange=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"note",r=e.target.name,i=e.target.value,l=Object(d.a)({},a.state.formControl);if("note"===n){var o=Object(d.a)({},l[r]);o.value=i,o.touch=!0,o.valid=F(i,o.validationRules),l[r]=o}else{var s=Object(d.a)({},l.links[t][r]);s.value=i,s.touch=!0,s.valid=F(i,s.validationRules),l.links[t][r]=s}a.setState({formValid:H(l,["children","_id","image","link_title"],!0),formControl:l})},a.deleteLink=function(e){var t=Object(d.a)({},a.state.formControl);t.links=t.links.filter((function(t){return t.id!==e.id})),a.setState({formControl:t,formValid:H(t,["children","_id","image","link_title"],!0)})},a.createLink=function(){var e=Object(d.a)({},a.state.formControl);e.links=[].concat(Object(u.a)(a.state.formControl.links),[{id:Date.now(),link:{value:"",valid:{isValid:!1,msg:[]},touch:!1,validationRules:{isRequired:!0,matchPattern:/[-a-zA-Z0-9@:%_+.~#?&/=]{2,256}\.[a-z]{2,4}\b(\/[-a-zA-Z0-9@:%_+.~#?&/=]*)?/gi}},desc:{value:"",touch:!1,valid:{isValid:!0,msg:[]},validationRules:{}},link_title:"",image:""}]),a.setState({formValid:!1,formControl:e})},a.handleOpenModal=function(){a.setState({open_modal:!0})},a.handleCloseModal=function(){a.setState({open_modal:!1})},a.handleDeleteNote=function(){var e=new Oe,t=a.state.note._id,n=a.props.token,r=a.props.show_err;a.setState({delete_spinner:!0,open_modal:!1}),e.delete_note(t,n).then((function(e){a.setState({delete_spinner:!1}),a.props.change_current_note(),a.props.history.push(ke)})).catch((function(e){return r(e)}))},a.submit=function(e){e.preventDefault();for(var t=a.state,n=t.formControl,r=t.note,i=a.props,l=i.token,o=i.change_current_note,s=i.show_err,c={_id:r._id,title:n.title.value,desc:n.desc.value},d=n.links.map((function(e){return{id:e.id,link:e.link.value,desc:e.desc.value,link_title:e.link_title,image:e.image}})),h=r.links.map((function(e){return e.id})),m=[],p=[],v=0;v<d.length;v++){var f=d[v],g=h.indexOf(f.id);g>=0&&r.links[g].link===f.link?p.push(f):(f.link_title=f.link,m.push(f))}a.setState({saving:!0});var b=new Oe;0===m.length?(c.links=p,b.update_note(c,l).then((function(e){a.setState({saving:!1,success:!0}),o(),setTimeout((function(){return a.props.history.push(ke)}),1e3)})).catch((function(e){return s(e)}))):ge(m).then((function(e){return c.links=[].concat(Object(u.a)(e),p),b.update_note(c,l)})).then((function(e){a.setState({saving:!1,success:!0}),o(),setTimeout((function(){return a.props.history.push(ke)}),1e3)})).catch((function(e){return s(e)}))},a.state={formValid:!0,formControl:{title:{value:"",valid:{isValid:!0,msg:[]},touch:!1,validationRules:{maxLen:50,isRequired:!0}},desc:{value:"",touch:!1,valid:{isValid:!0,msg:[]},validationRules:{}},links:[]},route:a.props.match.params.route,saving:!1,success:!1,note:{},open_modal:!1,delete_spinner:!1,update_spinner:!1},a}return Object(R.a)(n,[{key:"componentDidMount",value:function(){var e=Pe(this.props.notes,this.props.match.params.route),t=function(e){return Object.keys(e).length?e.links.map((function(e){return{id:e.id,link:{value:e.link,valid:{isValid:!0,msg:[]},touch:!1,validationRules:{isRequired:!0,matchPattern:/[-a-zA-Z0-9@:%_+.~#?&/=]{2,256}\.[a-z]{2,4}\b(\/[-a-zA-Z0-9@:%_+.~#?&/=]*)?/gi}},desc:{value:e.desc,touch:!1,valid:{isValid:!0,msg:[]},validationRules:{}},link_title:e.link_title,image:e.image}})):[]}(e),n=this.state.formControl;this.setState({note:e,formControl:{title:Object(d.a)(Object(d.a)({},n.title),{},{value:e.title}),desc:Object(d.a)(Object(d.a)({},n.desc),{},{value:e.desc}),links:t}})}},{key:"render",value:function(){var e=this.state.formControl,t=e.title,n=e.desc,a=e.links,i=this.state,l=i.success,o=i.saving,s=this.props,c=s.history;return s.notes.length||c.replace(ke),o||l?r.a.createElement("div",{className:"note-create"},l&&r.a.createElement(yt,{fontSize:"large",style:{color:U.a[500]}}),o&&r.a.createElement(jt,null)):r.a.createElement(T.a,{padding:1,"data-testid":"note-edit",className:"note-edit"},r.a.createElement("form",null,r.a.createElement(ne,{title:t,callback:this.handleChange}),r.a.createElement(ie,{value:n.value,callback:this.handleChange}),r.a.createElement(he,{createLink:this.createLink,links:a,handleChange:this.handleChange,deleteLink:this.deleteLink}),r.a.createElement(z.a,{"data-testid":"btn-cancel",onClick:this.goBack},"Cancel"),r.a.createElement(z.a,{"data-testid":"btn-update",onClick:this.submit,disabled:!this.state.formValid},"Update"),r.a.createElement(z.a,{"data-testid":"btn-delete",onClick:this.handleOpenModal,color:"secondary"},this.state.delete_spinner?r.a.createElement(P.a,{size:20}):"Delete Note"),r.a.createElement(ft.a,{"data-testid":"edit-dialog",open:this.state.open_modal,onClose:this.handleCloseModal,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description"},r.a.createElement(gt.a,{id:"alert-dialog-title"},"Are you sure about that?"),r.a.createElement(bt.a,null,r.a.createElement(_t.a,{id:"alert-dialog-description"},'You will delete note "'.concat(this.state.note.title,'", all his childrens and links.'),".")),r.a.createElement(kt.a,null,r.a.createElement(z.a,{"data-testid":"btn-dialog-dis",onClick:this.handleCloseModal,color:"primary"},"Disagree"),r.a.createElement(z.a,{"data-testid":"btn-dialog-ag",onClick:this.handleDeleteNote,color:"primary",autoFocus:!0},"Agree")))))}}]),n}(a.Component),Ot=Object(s.b)((function(e){return{notes:e.note.notes,token:e.user.token}}),(function(e){return{change_current_note:function(){return e(Q(""))},show_err:function(t){return e(ee(t))}}}))(Et),jt=Object(q.a)(P.a)({marginLeft:"calc(50% - 20px)"}),yt=Object(q.a)(G.a)({marginLeft:"calc(50% - 20px)"}),Ct=n(221),wt=n(222),St=n(224),xt=n(223),Rt={change_current_note:Q,log_out_user:S},Vt=function(e){Object(V.a)(n,e);var t=Object(L.a)(n);function n(e){var a;return Object(x.a)(this,n),(a=t.call(this,e)).handleDrawer=function(){a.setState({drawer:!a.state.drawer})},a.logOut=function(){a.props.log_out_user()},a.renderUserInfoOrSignBtns=function(){var e=a.props.user;return Object.keys(e).length?r.a.createElement(T.a,{display:"flex",justifyContent:"flex-end",alignItems:"center",flexGrow:"1"},r.a.createElement(Se.a,null,e.username),r.a.createElement(z.a,{onClick:a.logOut,color:"inherit"},"Sign Out")):r.a.createElement(T.a,{display:"flex",justifyContent:"flex-end",flexGrow:"1"},r.a.createElement(z.a,{color:"inherit"},r.a.createElement(Le.a,{color:"inherit",component:o.b,to:Ee},"Sign Up/In")))},a.state={drawer:!1},a}return Object(R.a)(n,[{key:"render",value:function(){var e=this.props,t=e.notes,n=e.currentMenu,a=e.change_current_note;return r.a.createElement(T.a,null,r.a.createElement(Ct.a,{position:"static"},r.a.createElement(wt.a,null,r.a.createElement(Re.a,{mdUp:!0},r.a.createElement(ce.a,{edge:"start",color:"inherit",onClick:this.handleDrawer,"aria-label":"menu"},r.a.createElement(xt.a,null))),this.renderUserInfoOrSignBtns())),r.a.createElement(Re.a,{mdUp:!0},r.a.createElement(St.a,{open:this.state.drawer,onClose:this.handleDrawer},r.a.createElement(T.a,{padding:2},r.a.createElement(ze,{notes:t,currentMenu:n,change_current_note:a})))))}}]),n}(a.Component),Lt=Object(s.b)((function(e){return{currentMenu:e.note.currentMenu,notes:e.note.notes,user:e.user.userData}}),Rt)(Vt),Nt=n(162),Tt=function(e){Object(V.a)(n,e);var t=Object(L.a)(n);function n(e){var a;return Object(x.a)(this,n),(a=t.call(this,e)).handleChange=function(e){var t,n,r,i=e.target,l=i.name,o=i.value,s=Object(d.a)({},a.state.formControls),c=Object(d.a)({},s[l]);if(c.value=o,c.touch=!0,c.valid=F(o,c.validationRules),"pass1"===l){var u="This password don't equal to first password";s.pass2.value===o?s.pass2.valid=F(s.pass2.value,s.pass2.validationRules):(s.pass2.valid.isValid=!1,!s.pass2.valid.msg.includes(u)&&s.pass2.touch&&s.pass2.valid.msg.push(u))}"pass2"===l&&(c.valid=(t=s.pass1.value,n=o,r=c.valid,t!==n&&(r.isValid=!1,r.msg.push("This password don't equal to first password")),r)),s[l]=c;var h=H(s);a.setState({formValid:h,formControls:s})},a.signUp=function(){var e=new Oe,t=a.state.formControls,n=a.props.show_err,r={username:t.user.value,pass:t.pass1.value};a.setState({show_spinner:!0}),e.sign_up(r).then((function(e){a.props.sign_up_user(e.data)})).catch((function(e){n(e),a.setState({show_spinner:!1})}))},a.state={formValid:!1,show_spinner:!1,formControls:{user:{value:"",touch:!1,valid:{isValid:!1,msg:[]},validationRules:{isRequired:!0,maxLen:50}},pass1:{value:"",touch:!1,valid:{isValid:!1,msg:[]},validationRules:{isRequired:!0}},pass2:{value:"",touch:!1,valid:{isValid:!1,msg:[]},validationRules:{isRequired:!0}}}},a}return Object(R.a)(n,[{key:"render",value:function(){var e=this.state,t=e.formValid,n=e.formControls,a=e.show_spinner,i=n.user,l=n.pass1,o=n.pass2;return r.a.createElement("form",null,Dt(i,"user","Username",this.handleChange),Dt(l,"pass1","Password",this.handleChange,"password"),Dt(o,"pass2","Repeat password",this.handleChange,"password"),r.a.createElement(T.a,{marginTop:"10px"},r.a.createElement(z.a,{disabled:!t,onClick:this.signUp},a?r.a.createElement(P.a,{size:20}):"Sign Up")))}}]),n}(a.Component);function Dt(e,t,n,a){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"text";return r.a.createElement(A.a,{error:!e.valid.isValid&&e.touch,helperText:e.valid.msg.join(", "),required:!0,value:e.value,fullWidth:!0,name:t,type:i,label:n,onChange:a})}var It=function(e){Object(V.a)(n,e);var t=Object(L.a)(n);function n(e){var a;return Object(x.a)(this,n),(a=t.call(this,e)).handleChange=function(e){var t=e.target,n=t.name,r=t.value,i=Object(d.a)({},a.state.formControls),l=Object(d.a)({},i[n]);l.touch=!0,l.value=r,l.valid=F(r,l.validationRules),i[n]=l;var o=H(i);a.setState({formValid:o,formControls:i})},a.logIn=function(){var e=new Oe,t=a.state.formControls,n=a.props.show_err,r={username:t.user.value,pass:t.pass.value};a.setState({show_spinner:!0}),e.log_in(r).then((function(e){a.props.log_in_user(e.data)})).catch((function(e){n(e),a.setState({show_spinner:!1})}))},a.handleClose=function(){a.setState({show_snack:!1,error:""})},a.state={formValid:!1,show_spinner:!1,formControls:{user:{value:"",touch:!1,valid:{isValid:!1,msg:[]},validationRules:{isRequired:!0}},pass:{value:"",touch:!1,valid:{isValid:!1,msg:[]},validationRules:{isRequired:!0}}}},a}return Object(R.a)(n,[{key:"render",value:function(){var e=this.state,t=e.formValid,n=e.formControls,a=e.show_spinner,i=n.user,l=n.pass;return r.a.createElement("form",null,Mt(i,"user","Username",this.handleChange),Mt(l,"pass","Password",this.handleChange,"password"),r.a.createElement(T.a,{marginTop:"10px"},r.a.createElement(z.a,{onClick:this.logIn,disabled:!t},a?r.a.createElement(P.a,{size:20}):"Sign In")))}}]),n}(a.Component);function Mt(e,t,n,a){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"text";return r.a.createElement(A.a,{error:!e.valid.isValid&&e.touch,helperText:e.valid.msg.join(", "),required:!0,value:e.value,fullWidth:!0,name:t,type:i,label:n,onChange:a})}var At={show_err:ee,sign_up_user:function(e){return{type:p,payload:e}},log_in_user:w},zt=function(e){Object(V.a)(n,e);var t=Object(L.a)(n);function n(e){var a;return Object(x.a)(this,n),(a=t.call(this,e)).state={sign_up:!0,sign_in:!1},a}return Object(R.a)(n,[{key:"renderButton",value:function(){var e=this;return this.state.sign_up?r.a.createElement(Se.a,null,"Already have an account?",r.a.createElement(z.a,{onClick:function(){return e.setState({sign_up:!1})}},"Sign In")):r.a.createElement(Se.a,null,"Don't have an account?",r.a.createElement(z.a,{onClick:function(){return e.setState({sign_in:!1})}},"Sign Up"))}},{key:"render",value:function(){var e=this,t=this.state,n=t.sign_up,a=t.sign_in,i=this.props,l=i.sign_up_user,o=i.log_in_user,s=i.show_err,c=i.user,u=i.history;return c.token&&u.replace(ke),r.a.createElement(T.a,{overflow:"hidden"},r.a.createElement(T.a,{width:"50%",margin:"0 auto"},r.a.createElement(Nt.a,{direction:"left",in:n,mountOnEnter:!0,unmountOnExit:!0,onExited:function(){return e.setState({sign_in:!0})}},r.a.createElement(Tt,{sign_up_user:l,show_err:s})),r.a.createElement(Nt.a,{direction:"right",in:a,mountOnEnter:!0,unmountOnExit:!0,onExited:function(){return e.setState({sign_up:!0})}},r.a.createElement(It,{log_in_user:o,show_err:s})),r.a.createElement(T.a,null,this.renderButton())))}}]),n}(a.Component),Pt=Object(s.b)((function(e){return{user:e.user}}),At)(zt),Bt=n(230),qt=n(231);function Ut(e){var t=e.open,n=e.msg,a=e.handleClose,i={open:t,autoHideDuration:4e3,anchorOrigin:{vertical:"top",horizontal:"right"},onClose:a},l={onClose:a,severity:e.saverity||"error"};return r.a.createElement(qt.a,i,r.a.createElement(Bt.a,l,n))}var Wt=Object(I.a)(N.a)({margin:"2.5% auto"}),Gt={hide_err:function(){return{type:_}}},Zt=function(e){Object(V.a)(n,e);var t=Object(L.a)(n);function n(){return Object(x.a)(this,n),t.apply(this,arguments)}return Object(R.a)(n,[{key:"render",value:function(){var e=this.props,t=e.token,n=e.hide_err,a=e.error;return t?r.a.createElement(T.a,null,r.a.createElement(Lt,null),r.a.createElement(D.a,{maxWidth:"md"},r.a.createElement(Wt,null,r.a.createElement(M.d,null,r.a.createElement(M.b,{path:ke,exact:!0,component:vt}),r.a.createElement(M.b,{path:be,component:ye}),r.a.createElement(M.b,{path:Ee,component:Pt}),r.a.createElement(M.b,{path:"".concat(_e,"/:route"),component:Ot}),r.a.createElement(M.a,{to:ke})))),r.a.createElement(Ut,{handleClose:n,msg:a.msg,open:a.show_err})):r.a.createElement(T.a,null,r.a.createElement(Lt,null),r.a.createElement(D.a,{maxWidth:"md"},r.a.createElement(Wt,null,r.a.createElement(Pt,null))),r.a.createElement(Ut,{handleClose:n,msg:a.msg,open:a.show_err}))}}]),n}(a.Component),Ft=Object(s.b)((function(e){return{token:e.user.token,error:e.error}}),Gt)(Zt);var Ht=function(){return r.a.createElement("div",{className:"App"},r.a.createElement(Ft,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));Promise.allSettled||(Promise.allSettled=function(e){return Promise.all(e.map((function(e){return Promise.resolve(e).then((function(e){return{status:"fulfilled",value:e}}),(function(e){return{status:"rejected",reason:e}}))})))});var Jt=localStorage.getItem("user");Jt&&C.dispatch(w(JSON.parse(Jt))),l.a.render(r.a.createElement(o.a,null,r.a.createElement(s.a,{store:C},r.a.createElement(Ht,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[128,1,2]]]);
//# sourceMappingURL=main.cc1a91df.chunk.js.map